# 飞行物体多约束下的最优非抓握捕获控制

## 飞行物体拦截背景

1. Multi-mode Trajectory Optimization for impact aware manipulation

**方法：**

- 使用二阶质量- 弹簧- 阻尼模型对整个系统进行建模
- 采用配点法， 在工作空间的

## 最优控制问题求解问题方法综述

<aside>
💡 **最优控制问题描述**： 对于一个受控系统，在满足约束条件下，寻求最优的控制量使性能指标最小。

</aside>

最优控制问题的数学形式：寻找控制变量u(t)**∈R_{m}, 使如下目标函数最小。**

![Untitled](%E9%A3%9E%E8%A1%8C%E7%89%A9%E4%BD%93%E5%A4%9A%E7%BA%A6%E6%9D%9F%E4%B8%8B%E7%9A%84%E6%9C%80%E4%BC%98%E9%9D%9E%E6%8A%93%E6%8F%A1%E6%8D%95%E8%8E%B7%E6%8E%A7%E5%88%B6%200cf18a40cb344185b9d3a2a56c02a2ec/Untitled.png)

最优控制问题的解决方式：直接法和间接法

- 间接法：将最优控制的一阶必要条件转化为Hamilton边值问题

变分法：将最优控制转化为两点边值问题，适用于容许控制为开集的情况。

极小值原理：解决变分法无法对控制进行约束的局限性。

- 直接法：先离散再优化，将最优控制问题转化为NLP问题

直接打靶法： 通过分段线性函数离散控制变量，积分状态方程获得终端状态。

直接配点法:：在配点出同时离散状态变量和控制变量，将微分方程约束转化为代数约束。

### **变分法：**

将最优控制转化为两点边值问题，适用于容许控制为开集的情况。

对于一个典型的Bolza型最优控制问题： 

![Untitled](%E9%A3%9E%E8%A1%8C%E7%89%A9%E4%BD%93%E5%A4%9A%E7%BA%A6%E6%9D%9F%E4%B8%8B%E7%9A%84%E6%9C%80%E4%BC%98%E9%9D%9E%E6%8A%93%E6%8F%A1%E6%8D%95%E8%8E%B7%E6%8E%A7%E5%88%B6%200cf18a40cb344185b9d3a2a56c02a2ec/Untitled%201.png)

引入拉格朗日算子λ(t)和哈密顿函数H：

![截屏2022-10-08 22.03.04.png](%E9%A3%9E%E8%A1%8C%E7%89%A9%E4%BD%93%E5%A4%9A%E7%BA%A6%E6%9D%9F%E4%B8%8B%E7%9A%84%E6%9C%80%E4%BC%98%E9%9D%9E%E6%8A%93%E6%8F%A1%E6%8D%95%E8%8E%B7%E6%8E%A7%E5%88%B6%200cf18a40cb344185b9d3a2a56c02a2ec/%25E6%2588%25AA%25E5%25B1%258F2022-10-08_22.03.04.png)

协态方程：λ ̇=−∂H/∂x    *欧拉方程*

状态方程： x ̇=∂H/∂λ

控制方程： ∂H/∂u=0  *最优控制问题的一阶必要极值条件*

结合边界条件： 

![截屏2022-10-08 22.07.40.png](%E9%A3%9E%E8%A1%8C%E7%89%A9%E4%BD%93%E5%A4%9A%E7%BA%A6%E6%9D%9F%E4%B8%8B%E7%9A%84%E6%9C%80%E4%BC%98%E9%9D%9E%E6%8A%93%E6%8F%A1%E6%8D%95%E8%8E%B7%E6%8E%A7%E5%88%B6%200cf18a40cb344185b9d3a2a56c02a2ec/%25E6%2588%25AA%25E5%25B1%258F2022-10-08_22.07.40.png)

得到横截条件：

![Untitled](%E9%A3%9E%E8%A1%8C%E7%89%A9%E4%BD%93%E5%A4%9A%E7%BA%A6%E6%9D%9F%E4%B8%8B%E7%9A%84%E6%9C%80%E4%BC%98%E9%9D%9E%E6%8A%93%E6%8F%A1%E6%8D%95%E8%8E%B7%E6%8E%A7%E5%88%B6%200cf18a40cb344185b9d3a2a56c02a2ec/Untitled%202.png)

### 最优控制问题求解方法综述：极小值原理

极小值原理：将最优控制问题转化为多点边值问题，控制变量u(t)受约束时求解最优控制问题。

- 容许控制条件放宽
- 最优控制时曼密顿函数取最小值
- 极小值原理不要求哈密顿函数对控制的可微性

对于一个典型的Bolza型最优控制问题

![Untitled](%E9%A3%9E%E8%A1%8C%E7%89%A9%E4%BD%93%E5%A4%9A%E7%BA%A6%E6%9D%9F%E4%B8%8B%E7%9A%84%E6%9C%80%E4%BC%98%E9%9D%9E%E6%8A%93%E6%8F%A1%E6%8D%95%E8%8E%B7%E6%8E%A7%E5%88%B6%200cf18a40cb344185b9d3a2a56c02a2ec/Untitled%203.png)

引入拉格朗日算子λ(t)和哈密顿函数H：

![截屏2022-10-09 11.10.51.png](%E9%A3%9E%E8%A1%8C%E7%89%A9%E4%BD%93%E5%A4%9A%E7%BA%A6%E6%9D%9F%E4%B8%8B%E7%9A%84%E6%9C%80%E4%BC%98%E9%9D%9E%E6%8A%93%E6%8F%A1%E6%8D%95%E8%8E%B7%E6%8E%A7%E5%88%B6%200cf18a40cb344185b9d3a2a56c02a2ec/%25E6%2588%25AA%25E5%25B1%258F2022-10-09_11.10.51.png)

协态方程： λ ̇=−∂H/∂x

状态方程： x ̇=∂H/∂λ

哈密顿函数相对最优控制为极小值：

![截屏2022-10-09 11.11.59.png](%E9%A3%9E%E8%A1%8C%E7%89%A9%E4%BD%93%E5%A4%9A%E7%BA%A6%E6%9D%9F%E4%B8%8B%E7%9A%84%E6%9C%80%E4%BC%98%E9%9D%9E%E6%8A%93%E6%8F%A1%E6%8D%95%E8%8E%B7%E6%8E%A7%E5%88%B6%200cf18a40cb344185b9d3a2a56c02a2ec/%25E6%2588%25AA%25E5%25B1%258F2022-10-09_11.11.59.png)

最优控制率：

![Untitled](%E9%A3%9E%E8%A1%8C%E7%89%A9%E4%BD%93%E5%A4%9A%E7%BA%A6%E6%9D%9F%E4%B8%8B%E7%9A%84%E6%9C%80%E4%BC%98%E9%9D%9E%E6%8A%93%E6%8F%A1%E6%8D%95%E8%8E%B7%E6%8E%A7%E5%88%B6%200cf18a40cb344185b9d3a2a56c02a2ec/Untitled%204.png)

结合边界条件：

![Untitled](%E9%A3%9E%E8%A1%8C%E7%89%A9%E4%BD%93%E5%A4%9A%E7%BA%A6%E6%9D%9F%E4%B8%8B%E7%9A%84%E6%9C%80%E4%BC%98%E9%9D%9E%E6%8A%93%E6%8F%A1%E6%8D%95%E8%8E%B7%E6%8E%A7%E5%88%B6%200cf18a40cb344185b9d3a2a56c02a2ec/Untitled%205.png)

得到横截条件：

![Untitled](%E9%A3%9E%E8%A1%8C%E7%89%A9%E4%BD%93%E5%A4%9A%E7%BA%A6%E6%9D%9F%E4%B8%8B%E7%9A%84%E6%9C%80%E4%BC%98%E9%9D%9E%E6%8A%93%E6%8F%A1%E6%8D%95%E8%8E%B7%E6%8E%A7%E5%88%B6%200cf18a40cb344185b9d3a2a56c02a2ec/Untitled%206.png)

### 最优控制问题求解方法综述：打靶法

- 打靶法
- 多重打靶法

<aside>
💡 **打靶法**：在时域上离散控制变量将其转化为NLP问题。（本质上都是讲一个最优控制问题转化为非线性优化问题）

</aside>

离散过程的数学描述：

![Untitled](%E9%A3%9E%E8%A1%8C%E7%89%A9%E4%BD%93%E5%A4%9A%E7%BA%A6%E6%9D%9F%E4%B8%8B%E7%9A%84%E6%9C%80%E4%BC%98%E9%9D%9E%E6%8A%93%E6%8F%A1%E6%8D%95%E8%8E%B7%E6%8E%A7%E5%88%B6%200cf18a40cb344185b9d3a2a56c02a2ec/Untitled%207.png)

φ_u为基函数

![Untitled](%E9%A3%9E%E8%A1%8C%E7%89%A9%E4%BD%93%E5%A4%9A%E7%BA%A6%E6%9D%9F%E4%B8%8B%E7%9A%84%E6%9C%80%E4%BC%98%E9%9D%9E%E6%8A%93%E6%8F%A1%E6%8D%95%E8%8E%B7%E6%8E%A7%E5%88%B6%200cf18a40cb344185b9d3a2a56c02a2ec/Untitled%208.png)

![截屏2022-10-09 11.22.40.png](%E9%A3%9E%E8%A1%8C%E7%89%A9%E4%BD%93%E5%A4%9A%E7%BA%A6%E6%9D%9F%E4%B8%8B%E7%9A%84%E6%9C%80%E4%BC%98%E9%9D%9E%E6%8A%93%E6%8F%A1%E6%8D%95%E8%8E%B7%E6%8E%A7%E5%88%B6%200cf18a40cb344185b9d3a2a56c02a2ec/%25E6%2588%25AA%25E5%25B1%258F2022-10-09_11.22.40.png)

<aside>
💡 **多重打靶法**：将[t_0,t_f]分为多个子区间，在每个子区间上进行打靶

</aside>

![Untitled](%E9%A3%9E%E8%A1%8C%E7%89%A9%E4%BD%93%E5%A4%9A%E7%BA%A6%E6%9D%9F%E4%B8%8B%E7%9A%84%E6%9C%80%E4%BC%98%E9%9D%9E%E6%8A%93%E6%8F%A1%E6%8D%95%E8%8E%B7%E6%8E%A7%E5%88%B6%200cf18a40cb344185b9d3a2a56c02a2ec/Untitled%209.png)

- 引入辅助变量s=[s_1,s_2,…,s_n−1]，s_k为状态变量在每个子区间上的初始值；
- 在离散控制变量后，利用状态变量子该时间网格下进行打靶
- 在每个时间网格边缘添加连续性约束

![Untitled](%E9%A3%9E%E8%A1%8C%E7%89%A9%E4%BD%93%E5%A4%9A%E7%BA%A6%E6%9D%9F%E4%B8%8B%E7%9A%84%E6%9C%80%E4%BC%98%E9%9D%9E%E6%8A%93%E6%8F%A1%E6%8D%95%E8%8E%B7%E6%8E%A7%E5%88%B6%200cf18a40cb344185b9d3a2a56c02a2ec/Untitled%2010.png)

![Untitled](%E9%A3%9E%E8%A1%8C%E7%89%A9%E4%BD%93%E5%A4%9A%E7%BA%A6%E6%9D%9F%E4%B8%8B%E7%9A%84%E6%9C%80%E4%BC%98%E9%9D%9E%E6%8A%93%E6%8F%A1%E6%8D%95%E8%8E%B7%E6%8E%A7%E5%88%B6%200cf18a40cb344185b9d3a2a56c02a2ec/Untitled%2011.png)

由离散后的控制变量，与初始状态共同作为输入，将最优控制问题转换为 NLP 问题，经过若干次迭代计算出最优控制 u* ，与此同时可以计算出状态变量曲线即最优轨迹 X*。

### 最优控制问题求解方法综述 配点法

<aside>
💡 **配点法**：在时域上同时离散状态变量和控制变量将其转化为NLP问题进行求解

</aside>

- 局部配点法（Local Collocation） 多采用有限元方法
- 全局配点法（Global Collocation） 多采用伪谱法

1. 在配点处离散状态变量和控制变量
2. 采用合适的基底函数在配点处近似状态变量和控制变量
3. 将最优控制问题中常微分方程（ODE）转化为等式代数约束
4. 将最优控制问题转化为NLP问题

局部配点法采用局域基底函数，即只在局部几个点非零，如B-样条；
全局配点法采用全域基底函数，即在整个实数域上大部分非零，如拉格朗日/牛顿多项式和三角函数（切比雪夫多项式）。

## 非抓握捕获（掌接）工作总结

![截屏2022-10-09 11.40.22.png](%E9%A3%9E%E8%A1%8C%E7%89%A9%E4%BD%93%E5%A4%9A%E7%BA%A6%E6%9D%9F%E4%B8%8B%E7%9A%84%E6%9C%80%E4%BC%98%E9%9D%9E%E6%8A%93%E6%8F%A1%E6%8D%95%E8%8E%B7%E6%8E%A7%E5%88%B6%200cf18a40cb344185b9d3a2a56c02a2ec/%25E6%2588%25AA%25E5%25B1%258F2022-10-09_11.40.22.png)

**捕获前位置最优轨迹生成：终端时刻自由，终端状态受约束的最优控制问题**

![截屏2022-10-09 11.46.24.png](%E9%A3%9E%E8%A1%8C%E7%89%A9%E4%BD%93%E5%A4%9A%E7%BA%A6%E6%9D%9F%E4%B8%8B%E7%9A%84%E6%9C%80%E4%BC%98%E9%9D%9E%E6%8A%93%E6%8F%A1%E6%8D%95%E8%8E%B7%E6%8E%A7%E5%88%B6%200cf18a40cb344185b9d3a2a56c02a2ec/%25E6%2588%25AA%25E5%25B1%258F2022-10-09_11.46.24.png)

**捕获前姿态最优轨迹生成：终端时刻自由，终端状态受约束的最优控制问题**

![截屏2022-10-09 11.48.06.png](%E9%A3%9E%E8%A1%8C%E7%89%A9%E4%BD%93%E5%A4%9A%E7%BA%A6%E6%9D%9F%E4%B8%8B%E7%9A%84%E6%9C%80%E4%BC%98%E9%9D%9E%E6%8A%93%E6%8F%A1%E6%8D%95%E8%8E%B7%E6%8E%A7%E5%88%B6%200cf18a40cb344185b9d3a2a56c02a2ec/%25E6%2588%25AA%25E5%25B1%258F2022-10-09_11.48.06.png)

**捕获后最优轨迹生成：消旋消速 三积分系统**

![截屏2022-10-09 11.50.49.png](%E9%A3%9E%E8%A1%8C%E7%89%A9%E4%BD%93%E5%A4%9A%E7%BA%A6%E6%9D%9F%E4%B8%8B%E7%9A%84%E6%9C%80%E4%BC%98%E9%9D%9E%E6%8A%93%E6%8F%A1%E6%8D%95%E8%8E%B7%E6%8E%A7%E5%88%B6%200cf18a40cb344185b9d3a2a56c02a2ec/%25E6%2588%25AA%25E5%25B1%258F2022-10-09_11.50.49.png)

捕获后最优轨迹生成：受力分析与奇异情况讨论

![截屏2022-10-09 11.52.14.png](%E9%A3%9E%E8%A1%8C%E7%89%A9%E4%BD%93%E5%A4%9A%E7%BA%A6%E6%9D%9F%E4%B8%8B%E7%9A%84%E6%9C%80%E4%BC%98%E9%9D%9E%E6%8A%93%E6%8F%A1%E6%8D%95%E8%8E%B7%E6%8E%A7%E5%88%B6%200cf18a40cb344185b9d3a2a56c02a2ec/%25E6%2588%25AA%25E5%25B1%258F2022-10-09_11.52.14.png)

![截屏2022-10-09 11.53.23.png](%E9%A3%9E%E8%A1%8C%E7%89%A9%E4%BD%93%E5%A4%9A%E7%BA%A6%E6%9D%9F%E4%B8%8B%E7%9A%84%E6%9C%80%E4%BC%98%E9%9D%9E%E6%8A%93%E6%8F%A1%E6%8D%95%E8%8E%B7%E6%8E%A7%E5%88%B6%200cf18a40cb344185b9d3a2a56c02a2ec/%25E6%2588%25AA%25E5%25B1%258F2022-10-09_11.53.23.png)

## 伪谱法求解原理

![截屏2022-10-09 11.57.41.png](%E9%A3%9E%E8%A1%8C%E7%89%A9%E4%BD%93%E5%A4%9A%E7%BA%A6%E6%9D%9F%E4%B8%8B%E7%9A%84%E6%9C%80%E4%BC%98%E9%9D%9E%E6%8A%93%E6%8F%A1%E6%8D%95%E8%8E%B7%E6%8E%A7%E5%88%B6%200cf18a40cb344185b9d3a2a56c02a2ec/%25E6%2588%25AA%25E5%25B1%258F2022-10-09_11.57.41.png)

![截屏2022-10-09 12.04.31.png](%E9%A3%9E%E8%A1%8C%E7%89%A9%E4%BD%93%E5%A4%9A%E7%BA%A6%E6%9D%9F%E4%B8%8B%E7%9A%84%E6%9C%80%E4%BC%98%E9%9D%9E%E6%8A%93%E6%8F%A1%E6%8D%95%E8%8E%B7%E6%8E%A7%E5%88%B6%200cf18a40cb344185b9d3a2a56c02a2ec/%25E6%2588%25AA%25E5%25B1%258F2022-10-09_12.04.31.png)

![截屏2022-10-09 12.04.53.png](%E9%A3%9E%E8%A1%8C%E7%89%A9%E4%BD%93%E5%A4%9A%E7%BA%A6%E6%9D%9F%E4%B8%8B%E7%9A%84%E6%9C%80%E4%BC%98%E9%9D%9E%E6%8A%93%E6%8F%A1%E6%8D%95%E8%8E%B7%E6%8E%A7%E5%88%B6%200cf18a40cb344185b9d3a2a56c02a2ec/%25E6%2588%25AA%25E5%25B1%258F2022-10-09_12.04.53.png)

![截屏2022-10-09 12.05.21.png](%E9%A3%9E%E8%A1%8C%E7%89%A9%E4%BD%93%E5%A4%9A%E7%BA%A6%E6%9D%9F%E4%B8%8B%E7%9A%84%E6%9C%80%E4%BC%98%E9%9D%9E%E6%8A%93%E6%8F%A1%E6%8D%95%E8%8E%B7%E6%8E%A7%E5%88%B6%200cf18a40cb344185b9d3a2a56c02a2ec/%25E6%2588%25AA%25E5%25B1%258F2022-10-09_12.05.21.png)

![截屏2022-10-09 12.05.48.png](%E9%A3%9E%E8%A1%8C%E7%89%A9%E4%BD%93%E5%A4%9A%E7%BA%A6%E6%9D%9F%E4%B8%8B%E7%9A%84%E6%9C%80%E4%BC%98%E9%9D%9E%E6%8A%93%E6%8F%A1%E6%8D%95%E8%8E%B7%E6%8E%A7%E5%88%B6%200cf18a40cb344185b9d3a2a56c02a2ec/%25E6%2588%25AA%25E5%25B1%258F2022-10-09_12.05.48.png)

## 复杂工况建模分析与求解

![截屏2022-10-09 12.07.30.png](%E9%A3%9E%E8%A1%8C%E7%89%A9%E4%BD%93%E5%A4%9A%E7%BA%A6%E6%9D%9F%E4%B8%8B%E7%9A%84%E6%9C%80%E4%BC%98%E9%9D%9E%E6%8A%93%E6%8F%A1%E6%8D%95%E8%8E%B7%E6%8E%A7%E5%88%B6%200cf18a40cb344185b9d3a2a56c02a2ec/%25E6%2588%25AA%25E5%25B1%258F2022-10-09_12.07.30.png)

![截屏2022-10-09 12.08.13.png](%E9%A3%9E%E8%A1%8C%E7%89%A9%E4%BD%93%E5%A4%9A%E7%BA%A6%E6%9D%9F%E4%B8%8B%E7%9A%84%E6%9C%80%E4%BC%98%E9%9D%9E%E6%8A%93%E6%8F%A1%E6%8D%95%E8%8E%B7%E6%8E%A7%E5%88%B6%200cf18a40cb344185b9d3a2a56c02a2ec/%25E6%2588%25AA%25E5%25B1%258F2022-10-09_12.08.13.png)

## 总结与工作展望

![Untitled](%E9%A3%9E%E8%A1%8C%E7%89%A9%E4%BD%93%E5%A4%9A%E7%BA%A6%E6%9D%9F%E4%B8%8B%E7%9A%84%E6%9C%80%E4%BC%98%E9%9D%9E%E6%8A%93%E6%8F%A1%E6%8D%95%E8%8E%B7%E6%8E%A7%E5%88%B6%200cf18a40cb344185b9d3a2a56c02a2ec/Untitled%2012.png)